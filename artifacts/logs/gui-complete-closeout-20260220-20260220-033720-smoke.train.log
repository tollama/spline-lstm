/Users/ychoi/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2026-02-20 03:37:51,110 INFO src.models.lstm - Built LSTM model: [64, 32]
2026-02-20 03:37:51.123823: E tensorflow/core/framework/node_def_util.cc:680] NodeDef mentions attribute use_unbounded_threadpool which is not in the op definition: Op<name=MapDataset; signature=input_dataset:variant, other_arguments: -> handle:variant; attr=f:func; attr=Targuments:list(type),min=0; attr=output_types:list(type),min=1; attr=output_shapes:list(shape),min=1; attr=use_inter_op_parallelism:bool,default=true; attr=preserve_cardinality:bool,default=false; attr=force_synchronous:bool,default=false; attr=metadata:string,default=""> This may be expected if your graph generating binary is newer  than this binary. Unknown attributes will be ignored. NodeDef: {{node ParallelMapDatasetV2/_15}}
[1m1/4[0m [32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ[0m[37m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ[0m [1m1s[0m 611ms/step - loss: 0.9210 - mae: 0.8707[1m4/4[0m [32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ[0m[37m[0m [1m1s[0m 39ms/step - loss: 0.8987 - mae: 0.8554 - val_loss: 0.9205 - val_mae: 0.9077
2026-02-20 03:37:51,923 INFO src.models.lstm - Model saved to artifacts/checkpoints/gui-complete-closeout-20260220-20260220-033720-smoke/last.keras
2026-02-20 03:37:51,948 INFO __main__ - Run complete: gui-complete-closeout-20260220-20260220-033720-smoke
{
  "run_id": "gui-complete-closeout-20260220-20260220-033720-smoke",
  "backend": "tensorflow",
  "config": {
    "sequence_length": 24,
    "horizon": 1,
    "hidden_units": [
      64,
      32
    ],
    "dropout": 0.2,
    "learning_rate": 0.001,
    "epochs": 1,
    "batch_size": 32,
    "test_size": 0.2,
    "val_size": 0.2,
    "normalize": true,
    "normalize_method": "minmax",
    "seed": 42,
    "deterministic": true,
    "ma_window": null,
    "processed_npz": "artifacts/processed/gui-complete-closeout-20260220-20260220-033720-smoke/processed.npz",
    "preprocessor_pkl": "artifacts/models/gui-complete-closeout-20260220-20260220-033720-smoke/preprocessor.pkl",
    "input_npy": null,
    "synthetic_samples": 800,
    "synthetic_noise": 0.08,
    "model_type": "lstm",
    "feature_mode": "univariate",
    "target_cols": [
      "target"
    ],
    "dynamic_covariates": [],
    "static_covariates": [],
    "covariate_spec": {},
    "covariate_contract": {
      "enabled": false,
      "schema_version": null,
      "dynamic_covariates": [],
      "static_covariates": [],
      "required_missing": [],
      "declared_missing_in_columns": [],
      "spec": {}
    },
    "export_formats": [
      "none"
    ]
  },
  "metrics": {
    "mae": 0.694982647895813,
    "mse": 0.6119686365127563,
    "rmse": 0.7822842597961426,
    "mape": 108.18438720703125,
    "mase": 6.446465015411377,
    "r2": 0.0019015669822692871
  },
  "baselines": {
    "lstm": {
      "mae": 0.694982647895813,
      "mse": 0.6119686365127563,
      "rmse": 0.7822842597961426,
      "mape": 108.18438720703125,
      "r2": 0.0019015669822692871
    },
    "naive_last": {
      "mae": 0.10789342224597931,
      "mse": 0.01646076701581478,
      "rmse": 0.1282995194196701,
      "mape": 27.675289154052734,
      "r2": 0.9731531143188477
    },
    "moving_average_24": {
      "window": 24,
      "mae": 0.9058740735054016,
      "mse": 1.0266978740692139,
      "rmse": 1.0132609605789185,
      "mape": 246.7637939453125,
      "r2": -0.6745065450668335
    },
    "relative_improvement_rmse_pct": {
      "vs_naive_last": -509.7327662342988,
      "vs_moving_average_24": 22.79538119886422
    },
    "metrics": {
      "model": {
        "mae": 0.694982647895813,
        "mse": 0.6119686365127563,
        "rmse": 0.7822842597961426,
        "mape": 108.18438720703125,
        "r2": 0.0019015669822692871
      },
      "baseline": {
        "naive": {
          "mae": 0.10789342224597931,
          "mse": 0.01646076701581478,
          "rmse": 0.1282995194196701,
          "mape": 27.675289154052734,
          "r2": 0.9731531143188477
        },
        "ma": {
          "window": 24,
          "mae": 0.9058740735054016,
          "mse": 1.0266978740692139,
          "rmse": 1.0132609605789185,
          "mape": 246.7637939453125,
          "r2": -0.6745065450668335
        }
      },
      "delta_vs_baseline": {
        "naive": {
          "rmse_improvement_pct": -509.7327662342988
        },
        "ma": {
          "rmse_improvement_pct": 22.79538119886422
        }
      }
    },
    "evaluation_context": {
      "split": "test",
      "scale": "train_fit_only_then_transform",
      "horizon": 1,
      "sequence_length": 24
    }
  },
  "checkpoints": {
    "best": "artifacts/checkpoints/gui-complete-closeout-20260220-20260220-033720-smoke/best.keras",
    "last": "artifacts/checkpoints/gui-complete-closeout-20260220-20260220-033720-smoke/last.keras"
  },
  "preprocessor": "artifacts/models/gui-complete-closeout-20260220-20260220-033720-smoke/preprocessor.pkl",
  "split_indices": {
    "n_total": 156,
    "train": {
      "start": 0,
      "end": 99
    },
    "val": {
      "start": 99,
      "end": 124
    },
    "test": {
      "start": 124,
      "end": 156
    },
    "ratios": {
      "test_size": 0.2,
      "val_size": 0.2
    },
    "source": "processed_xy"
  },
  "inference": {
    "x_shape": [
      1,
      24,
      1
    ],
    "y_true_last": [
      -1.0202330350875854
    ],
    "y_pred_last": [
      -0.45640841126441956
    ],
    "predictions_csv": "artifacts/predictions/gui-complete-closeout-20260220-20260220-033720-smoke.csv"
  },
  "timestamps": {
    "start": "2026-02-20T03:37:51.092629",
    "end": "2026-02-20T03:37:51.916153",
    "saved_at": "2026-02-20T03:37:51.947556"
  },
  "commit_hash": null,
  "commit_hash_source": "unavailable",
  "metadata_path": "artifacts/metadata/gui-complete-closeout-20260220-20260220-033720-smoke.json",
  "runmeta_path": "artifacts/runs/gui-complete-closeout-20260220-20260220-033720-smoke.meta.json",
  "covariate_schema": {
    "enabled": false,
    "schema_version": null,
    "dynamic_covariates": [],
    "static_covariates": [],
    "required_missing": [],
    "declared_missing_in_columns": [],
    "spec": {}
  }
}
